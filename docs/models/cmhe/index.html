<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>auton_survival.models.cmhe API documentation</title>
<meta name="description" content="Cox Mixtures with Heterogenous Effects
â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'G-TTD30SJCTB', 'auto'); ga('send', 'pageview');
</script><script async src='https://www.google-analytics.com/analytics.js'></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>auton_survival.models.cmhe</code></h1>
</header>
<section id="section-intro">
<h2 id="cox-mixtures-with-heterogenous-effects">Cox Mixtures With Heterogenous Effects</h2>
<p><a href="https://travis-ci.org/autonlab/DeepSurvivalMachines"><img alt="Build Status" src="https://travis-ci.org/autonlab/DeepSurvivalMachines.svg?branch=master"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://codecov.io/gh/autonlab/DeepSurvivalMachines"><img alt="codecov" src="https://codecov.io/gh/autonlab/DeepSurvivalMachines/branch/master/graph/badge.svg?token=FU1HB5O92D"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://opensource.org/licenses/MIT"><img alt="License: MIT" src="https://img.shields.io/badge/License-MIT-yellow.svg"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://github.com/autonlab/auton-survival"><img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/autonlab/auton-survival?style=social"></a></p>
<p><img
src="https://ndownloader.figshare.com/files/34056269"></p>
<p><img align="right" width=35% src="https://figshare.com/ndownloader/files/34056284"></p>
<p><strong>Cox Mixture with Heterogenous Effects (CMHE)</strong> is a flexible approach to
recover counterfactual phenotypes of individuals that demonstrate heterogneous
effects to an intervention in terms of censored Time-to-Event outcomes.
CMHE is <strong>not</strong> restricted by the strong Cox Proportional Hazards assumption
or any parametric assumption on the time to event distributions. CMHE achieves
this by describing each individual as belonging to two different latent groups,
<span><span class="MathJax_Preview"> \mathcal{Z} </span><script type="math/tex"> \mathcal{Z} </script></span> that mediate the base survival rate and <span><span class="MathJax_Preview"> \phi </span><script type="math/tex"> \phi </script></span> the effect
of the treatment. CMHE can also be employed to model individual level
counterfactuals or for standard factual survival regression.</p>
<p>For full details on Cox Mixtures with Heterogenous Effects, please refer to
our preprint:</p>
<p><a href="https://arxiv.org/abs/2202.11089">Counterfactual Phenotyping with Censored Time-to-Events, arXiv preprint,
C. Nagpal, M. Goswami, K. Dufendach, A. Dubrawski</a></p>
<p><br></p>
<h2 id="example-usage">Example Usage</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; from auton_survival import DeepCoxMixturesHeterogenousEffects
&gt;&gt;&gt; from auton_survival import datasets
&gt;&gt;&gt; # load the SYNTHETIC dataset.
&gt;&gt;&gt; x, t, e, a = datasets.load_dataset('SYNTHETIC')
&gt;&gt;&gt; # instantiate a Cox Mixtures with Heterogenous Effects model.
&gt;&gt;&gt; model = DeepCoxMixturesHeterogenousEffects()
&gt;&gt;&gt; # fit the model to the dataset.
&gt;&gt;&gt; model.fit(x, t, e, a)
&gt;&gt;&gt; # estimate the predicted risks at the time
&gt;&gt;&gt; model.predict_risk(x, 10)
&gt;&gt;&gt; # estimate the treatment effect phenogroups
&gt;&gt;&gt; model.predict_latent_phi(x)
</code></pre>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="auton_survival.models.cmhe.cmhe_torch" href="cmhe_torch.html">auton_survival.models.cmhe.cmhe_torch</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="auton_survival.models.cmhe.cmhe_utilities" href="cmhe_utilities.html">auton_survival.models.cmhe.cmhe_utilities</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects"><code class="flex name class">
<span>class <span class="ident">DeepCoxMixturesHeterogenousEffects</span></span>
<span>(</span><span>k, g, layers=None, gamma=100, smoothing_factor=0.0001, gate_l2_penalty=0.0001, random_seed=0)</span>
</code></dt>
<dd>
<div class="desc"><p>A Deep Cox Mixtures with Heterogenous Effects model.</p>
<p>This is the main interface to a Deep Cox Mixture with Heterogenous Effects.
A model is instantiated with approporiate set of hyperparameters and
fit on numpy arrays consisting of the features, event/censoring times
and the event/censoring indicators.</p>
<p>For full details on Deep Cox Mixture, refer to the paper [1].</p>
<h2 id="references">References</h2>
<p>[1] Nagpal, C., Goswami M., Dufendach K., and Artur Dubrawski.
"Counterfactual phenotyping for censored Time-to-Events" (2022).</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>k</code></strong> :&ensp;<code>int</code></dt>
<dd>The number of underlying base survival phenotypes.</dd>
<dt><strong><code>g</code></strong> :&ensp;<code>int</code></dt>
<dd>The number of underlying treatment effect phenotypes.</dd>
<dt><strong><code>layers</code></strong> :&ensp;<code>list</code></dt>
<dd>A list of integers consisting of the number of neurons in each
hidden layer.</dd>
<dt><strong><code>gate_l2_penalty</code></strong> :&ensp;<code>float</code></dt>
<dd>Strength of the l2 penalty term for the gate layers.
Higher means stronger regularization.</dd>
<dt><strong><code>random_seed</code></strong> :&ensp;<code>int</code></dt>
<dd>Controls the reproducibility of called functions.</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; from auton_survival import DeepCoxMixturesHeterogenousEffects
&gt;&gt;&gt; model = DeepCoxMixturesHeterogenousEffects(k=2, g=3)
&gt;&gt;&gt; model.fit(x, t, e, a)
</code></pre></div>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
<h3>Methods</h3>
<dl>
<dt id="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.fit"><code class="name flex">
<span>def <span class="ident">fit</span></span>(<span>self, x, t, e, a, vsize=0.15, val_data=None, iters=1, learning_rate=0.001, batch_size=100, patience=2, optimizer='Adam')</span>
</code></dt>
<dd>
<div class="desc"><p>This method is used to train an instance of the DSM model.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>np.ndarray</code></dt>
<dd>A numpy array of the input features, <span><span class="MathJax_Preview"> x </span><script type="math/tex"> x </script></span>.</dd>
<dt><strong><code>t</code></strong> :&ensp;<code>np.ndarray</code></dt>
<dd>A numpy array of the event/censoring times, <span><span class="MathJax_Preview"> t </span><script type="math/tex"> t </script></span>.</dd>
<dt><strong><code>e</code></strong> :&ensp;<code>np.ndarray</code></dt>
<dd>A numpy array of the event/censoring indicators, <span><span class="MathJax_Preview"> \delta </span><script type="math/tex"> \delta </script></span>.
<span><span class="MathJax_Preview"> \delta = 1 </span><script type="math/tex"> \delta = 1 </script></span> means the event took place.</dd>
<dt><strong><code>a</code></strong> :&ensp;<code>np.ndarray</code></dt>
<dd>A numpy array of the treatment assignment indicators, <span><span class="MathJax_Preview"> a </span><script type="math/tex"> a </script></span>.
<span><span class="MathJax_Preview"> a = 1 </span><script type="math/tex"> a = 1 </script></span> means the individual was treated.</dd>
<dt><strong><code>vsize</code></strong> :&ensp;<code>float</code></dt>
<dd>Amount of data to set aside as the validation set.</dd>
<dt><strong><code>val_data</code></strong> :&ensp;<code>tuple</code></dt>
<dd>A tuple of the validation dataset. If passed vsize is ignored.</dd>
<dt><strong><code>iters</code></strong> :&ensp;<code>int</code></dt>
<dd>The maximum number of training iterations on the training dataset.</dd>
<dt><strong><code>learning_rate</code></strong> :&ensp;<code>float</code></dt>
<dd>The learning rate for the <code>Adam</code> optimizer.</dd>
<dt><strong><code>batch_size</code></strong> :&ensp;<code>int</code></dt>
<dd>learning is performed on mini-batches of input data. this parameter
specifies the size of each mini-batch.</dd>
<dt><strong><code>optimizer</code></strong> :&ensp;<code>str</code></dt>
<dd>The choice of the gradient based optimization method. One of
'Adam', 'RMSProp' or 'SGD'.</dd>
</dl></div>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
</dd>
<dt id="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_risk"><code class="name flex">
<span>def <span class="ident">predict_risk</span></span>(<span>self, x, a, t=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
</dd>
<dt id="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_survival"><code class="name flex">
<span>def <span class="ident">predict_survival</span></span>(<span>self, x, a, t=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the estimated survival probability at time <span><span class="MathJax_Preview"> t </span><script type="math/tex"> t </script></span>,
<span><span class="MathJax_Preview"> \widehat{\mathbb{P}}(T &gt; t|X) </span><script type="math/tex"> \widehat{\mathbb{P}}(T > t|X) </script></span> for some input data <span><span class="MathJax_Preview"> x </span><script type="math/tex"> x </script></span>.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>np.ndarray</code></dt>
<dd>A numpy array of the input features, <span><span class="MathJax_Preview"> x </span><script type="math/tex"> x </script></span>.</dd>
<dt><strong><code>a</code></strong> :&ensp;<code>np.ndarray</code></dt>
<dd>A numpy array of the treatmeant assignment, <span><span class="MathJax_Preview"> a </span><script type="math/tex"> a </script></span>.</dd>
<dt><strong><code>t</code></strong> :&ensp;<code>list</code> or <code>float</code></dt>
<dd>a list or float of the times at which survival probability is
to be computed</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>np.array</code></dt>
<dd>numpy array of the survival probabilites at each time in t.</dd>
</dl></div>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
</dd>
<dt id="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_latent_z"><code class="name flex">
<span>def <span class="ident">predict_latent_z</span></span>(<span>self, x)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the estimated latent base survival group <span><span class="MathJax_Preview"> z </span><script type="math/tex"> z </script></span> given the confounders <span><span class="MathJax_Preview"> x </span><script type="math/tex"> x </script></span>.</p></div>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
</dd>
<dt id="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_latent_phi"><code class="name flex">
<span>def <span class="ident">predict_latent_phi</span></span>(<span>self, x)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the estimated latent treatment effect group <span><span class="MathJax_Preview"> \phi </span><script type="math/tex"> \phi </script></span> given the confounders <span><span class="MathJax_Preview"> x </span><script type="math/tex"> x </script></span>.</p></div>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<img src="https://ndownloader.figshare.com/files/34052981">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#cox-mixtures-with-heterogenous-effects">Cox Mixtures with Heterogenous Effects</a></li>
<li><a href="#example-usage">Example Usage</a></li>
</ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="auton_survival.models" href="../index.html">auton_survival.models</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="auton_survival.models.cmhe.cmhe_torch" href="cmhe_torch.html">auton_survival.models.cmhe.cmhe_torch</a></code></li>
<li><code><a title="auton_survival.models.cmhe.cmhe_utilities" href="cmhe_utilities.html">auton_survival.models.cmhe.cmhe_utilities</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects" href="#auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects">DeepCoxMixturesHeterogenousEffects</a></code></h4>
<ul class="">
<li><code><a title="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.fit" href="#auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.fit">fit</a></code></li>
<li><code><a title="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_risk" href="#auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_risk">predict_risk</a></code></li>
<li><code><a title="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_survival" href="#auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_survival">predict_survival</a></code></li>
<li><code><a title="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_latent_z" href="#auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_latent_z">predict_latent_z</a></code></li>
<li><code><a title="auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_latent_phi" href="#auton_survival.models.cmhe.DeepCoxMixturesHeterogenousEffects.predict_latent_phi">predict_latent_phi</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>