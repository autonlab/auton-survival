<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>auton_survival.models.dsm API documentation</title>
<meta name="description" content="Deep Survival Machines
â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'G-TTD30SJCTB', 'auto'); ga('send', 'pageview');
</script><script async src='https://www.google-analytics.com/analytics.js'></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>auton_survival.models.dsm</code></h1>
</header>
<section id="section-intro">
<h2 id="deep-survival-machines">Deep Survival Machines</h2>
<p><img alt=":figwidth: 20 %
:alt: Schematic Description of Deep Survival Machines
Schematic Description of Deep Survival Machines." src="https://ndownloader.figshare.com/files/25259852"></p>
<p><strong>Deep Survival Machines (DSM)</strong> is a fully parametric approach to model
Time-to-Event outcomes in the presence of Censoring first introduced in
<a href="https://arxiv.org/abs/2003.01176">[1]</a>.
In the context of Healthcare ML and Biostatistics, this is known as 'Survival
Analysis'. The key idea behind Deep Survival Machines is to model the
underlying event outcome distribution as a mixure of some fixed <span><span class="MathJax_Preview"> k </span><script type="math/tex"> k </script></span>
parametric distributions. The parameters of these mixture distributions as
well as the mixing weights are modelled using Neural Networks.</p>
<h2 id="example-usage">Example Usage</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; from dsm import DeepSurvivalMachines
&gt;&gt;&gt; from dsm import datasets
&gt;&gt;&gt; # load the SUPPORT dataset.
&gt;&gt;&gt; x, t, e = datasets.load_dataset('SUPPORT')
&gt;&gt;&gt; # instantiate a DeepSurvivalMachines model.
&gt;&gt;&gt; model = DeepSurvivalMachines()
&gt;&gt;&gt; # fit the model to the dataset.
&gt;&gt;&gt; model.fit(x, t, e)
&gt;&gt;&gt; # estimate the predicted risks at the time
&gt;&gt;&gt; model.predict_risk(x, 10)
</code></pre>
<h2 id="deep-recurrent-survival-machines">Deep Recurrent Survival Machines</h2>
<p><img alt=":figwidth: 20 %
:alt: Schematic Description of Deep Survival Machines
Schematic Description of Deep Survival Machines." src="https://ndownloader.figshare.com/files/28329918"></p>
<p><strong>Deep Recurrent Survival Machines (DRSM)</strong> builds on the original <strong>DSM</strong>
model and allows for learning of representations of the input covariates using
<strong>Recurrent Neural Networks</strong> like <strong>LSTMs, GRUs</strong>. Deep Recurrent Survival
Machines is a natural fit to model problems where there are time dependendent
covariates. Examples include situations where we are working with streaming
data like vital signs, degradation monitoring signals in predictive
maintainance. <strong>DRSM</strong> allows the learnt representations at each time step to
involve historical context from previous time steps. <strong>DRSM</strong> implementation in
<code>dsm</code> is carried out through an easy to use API,
<code><a title="auton_survival.models.dsm.DeepRecurrentSurvivalMachines" href="#auton_survival.models.dsm.DeepRecurrentSurvivalMachines">DeepRecurrentSurvivalMachines</a></code> that accepts lists of data streams and
corresponding failure times. The module automatically takes care of appropriate
batching and padding of variable length sequences.</p>
<h2 id="deep-convolutional-survival-machines">Deep Convolutional Survival Machines</h2>
<p>Predictive maintenance and medical imaging sometimes requires to work with
image streams. Deep Convolutional Survival Machines extends <strong>DSM</strong> and
<strong>DRSM</strong> to learn representations of the input image data using
convolutional layers. If working with streaming data, the learnt
representations are then passed through an LSTM to model temporal dependencies
before determining the underlying survival distributions.</p>
<div class="admonition warning">
<p class="admonition-title">Warning:&ensp;Not Implemented Yet!</p>
</div>
<h2 id="references">References</h2>
<p>Please cite the following papers if you are using the <code><a title="auton_survival" href="../../index.html">auton_survival</a></code> package.</p>
<p>[1] <a href="https://arxiv.org/abs/2003.01176">Deep Survival Machines:
Fully Parametric Survival Regression and
Representation Learning for Censored Data with Competing Risks."
IEEE Journal of Biomedical and Health Informatics (2021)</a></a></p>
<pre><code>  @article{nagpal2021dsm,
  title={Deep survival machines: Fully parametric survival regression and representation learning for censored data with competing risks},
  author={Nagpal, Chirag and Li, Xinyu and Dubrawski, Artur},
  journal={IEEE Journal of Biomedical and Health Informatics},
  volume={25},
  number={8},
  pages={3163--3175},
  year={2021},
  publisher={IEEE}
  }
</code></pre>
<p>[2] <a href="http://proceedings.mlr.press/v146/nagpal21a.html">Deep Parametric Time-to-Event Regression with Time-Varying Covariates. AAAI
Spring Symposium (2021)</a></a></p>
<pre><code>  @InProceedings{pmlr-v146-nagpal21a,
  title={Deep Parametric Time-to-Event Regression with Time-Varying Covariates},
  author={Nagpal, Chirag and Jeanselme, Vincent and Dubrawski, Artur},
  booktitle={Proceedings of AAAI Spring Symposium on Survival Prediction - Algorithms, Challenges, and Applications 2021},
  series={Proceedings of Machine Learning Research},
  publisher={PMLR},
  }
</code></pre>
<p>[3] <a href="https://arxiv.org/abs/2101.06536">Deep Cox Mixtures for Survival Regression. Conference on Machine Learning for
Healthcare (2021)</a></a></p>
<pre><code>  @inproceedings{nagpal2021dcm,
  title={Deep Cox mixtures for survival regression},
  author={Nagpal, Chirag and Yadlowsky, Steve and Rostamzadeh, Negar and Heller, Katherine},
  booktitle={Machine Learning for Healthcare Conference},
  pages={674--708},
  year={2021},
  organization={PMLR}
  }
</code></pre>
<p>[4] <a href="https://arxiv.org/abs/2202.11089">Counterfactual Phenotyping with Censored Time-to-Events (2022)</a></a></p>
<pre><code>  @article{nagpal2022counterfactual,
  title={Counterfactual Phenotyping with Censored Time-to-Events},
  author={Nagpal, Chirag and Goswami, Mononito and Dufendach, Keith and Dubrawski, Artur},
  journal={arXiv preprint arXiv:2202.11089},
  year={2022}
  }
</code></pre>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="auton_survival.models.dsm.datasets" href="datasets.html">auton_survival.models.dsm.datasets</a></code></dt>
<dd>
<div class="desc"><p>Utility functions to load standard datasets to train and evaluate the
Deep Survival Machines models.</p></div>
</dd>
<dt><code class="name"><a title="auton_survival.models.dsm.dsm_torch" href="dsm_torch.html">auton_survival.models.dsm.dsm_torch</a></code></dt>
<dd>
<div class="desc"><p>Torch model definitons for the Deep Survival Machines model</p>
<p>This includes definitons for the Torch Deep Survival Machines module.
The main interface is the DeepSurvivalMachines class which inherits
from torch.nn.Module.</p>
<p>Note: NOT DESIGNED TO BE CALLED DIRECTLY!!!</p></div>
</dd>
<dt><code class="name"><a title="auton_survival.models.dsm.losses" href="losses.html">auton_survival.models.dsm.losses</a></code></dt>
<dd>
<div class="desc"><p>Loss function definitions for the Deep Survival Machines model</p>
<p>In this module we define the various losses for the censored and uncensored
instances of data corresponding to Weibull and LogNormal distributions.
These losses are optimized when training DSM.</p>
<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p>Use torch.distributions</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>NOT DESIGNED TO BE CALLED DIRECTLY!!!</p>
</div></div>
</dd>
<dt><code class="name"><a title="auton_survival.models.dsm.utilities" href="utilities.html">auton_survival.models.dsm.utilities</a></code></dt>
<dd>
<div class="desc"><p>Utility functions to train the Deep Survival Machines models</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="auton_survival.models.dsm.DeepSurvivalMachines"><code class="flex name class">
<span>class <span class="ident">DeepSurvivalMachines</span></span>
<span>(</span><span>k=3, layers=None, distribution='Weibull', temp=1000.0, discount=1.0, random_seed=0)</span>
</code></dt>
<dd>
<div class="desc"><p>A Deep Survival Machines model.</p>
<p>This is the main interface to a Deep Survival Machines model.
A model is instantiated with approporiate set of hyperparameters and
fit on numpy arrays consisting of the features, event/censoring times
and the event/censoring indicators.</p>
<p>For full details on Deep Survival Machines, refer to our paper [1].</p>
<h2 id="references">References</h2>
<p>[1] <a href="https://arxiv.org/abs/2003.01176">Deep Survival Machines:
Fully Parametric Survival Regression and
Representation Learning for Censored Data with Competing Risks."
arXiv preprint arXiv:2003.01176 (2020)</a></p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>k</code></strong> :&ensp;<code>int</code></dt>
<dd>The number of underlying parametric distributions.</dd>
<dt><strong><code>layers</code></strong> :&ensp;<code>list</code></dt>
<dd>A list of integers consisting of the number of neurons in each
hidden layer.</dd>
<dt><strong><code>distribution</code></strong> :&ensp;<code>str</code></dt>
<dd>Choice of the underlying survival distributions.
One of 'Weibull', 'LogNormal'.
Default is 'Weibull'.</dd>
<dt><strong><code>temp</code></strong> :&ensp;<code>float</code></dt>
<dd>The logits for the gate are rescaled with this value.
Default is 1000.</dd>
<dt><strong><code>discount</code></strong> :&ensp;<code>float</code></dt>
<dd>a float in [0,1] that determines how to discount the tail bias
from the uncensored instances.
Default is 1.</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; from dsm import DeepSurvivalMachines
&gt;&gt;&gt; model = DeepSurvivalMachines()
&gt;&gt;&gt; model.fit(x, t, e)
</code></pre></div>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
</dd>
<dt id="auton_survival.models.dsm.DeepRecurrentSurvivalMachines"><code class="flex name class">
<span>class <span class="ident">DeepRecurrentSurvivalMachines</span></span>
<span>(</span><span>k=3, layers=None, hidden=None, distribution='Weibull', temp=1000.0, discount=1.0, typ='LSTM', random_seed=0)</span>
</code></dt>
<dd>
<div class="desc"><p>The Deep Recurrent Survival Machines model to handle data with
time-dependent covariates.</p>
<p>For full details on Deep Recurrent Survival Machines, refer to our paper [1].</p>
<h2 id="references">References</h2>
<p>[1] <a href="http://proceedings.mlr.press/v146/nagpal21a.html">
Deep Parametric Time-to-Event Regression with Time-Varying Covariates
AAAI Spring Symposium on Survival Prediction</a></p></div>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
</dd>
<dt id="auton_survival.models.dsm.DeepConvolutionalSurvivalMachines"><code class="flex name class">
<span>class <span class="ident">DeepConvolutionalSurvivalMachines</span></span>
<span>(</span><span>k=3, layers=None, hidden=None, distribution='Weibull', temp=1000.0, discount=1.0, typ='ConvNet')</span>
</code></dt>
<dd>
<div class="desc"><p>The Deep Convolutional Survival Machines model to handle data with
image-based covariates.</p></div>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
</dd>
<dt id="auton_survival.models.dsm.DeepCNNRNNSurvivalMachines"><code class="flex name class">
<span>class <span class="ident">DeepCNNRNNSurvivalMachines</span></span>
<span>(</span><span>k=3, layers=None, hidden=None, distribution='Weibull', temp=1000.0, discount=1.0, typ='LSTM')</span>
</code></dt>
<dd>
<div class="desc"><p>The Deep CNN-RNN Survival Machines model to handle data with
moving image streams.</p></div>
<div class="git-link-div"><a href="https://github.com/autonlab/auton-survival" class="git-link">Browse git</a></div>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<img src="https://ndownloader.figshare.com/files/34052981">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#deep-survival-machines">Deep Survival Machines</a></li>
<li><a href="#example-usage">Example Usage</a></li>
<li><a href="#deep-recurrent-survival-machines">Deep Recurrent Survival Machines</a></li>
<li><a href="#deep-convolutional-survival-machines">Deep Convolutional Survival Machines</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="auton_survival.models" href="../index.html">auton_survival.models</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="auton_survival.models.dsm.datasets" href="datasets.html">auton_survival.models.dsm.datasets</a></code></li>
<li><code><a title="auton_survival.models.dsm.dsm_torch" href="dsm_torch.html">auton_survival.models.dsm.dsm_torch</a></code></li>
<li><code><a title="auton_survival.models.dsm.losses" href="losses.html">auton_survival.models.dsm.losses</a></code></li>
<li><code><a title="auton_survival.models.dsm.utilities" href="utilities.html">auton_survival.models.dsm.utilities</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="auton_survival.models.dsm.DeepSurvivalMachines" href="#auton_survival.models.dsm.DeepSurvivalMachines">DeepSurvivalMachines</a></code></h4>
</li>
<li>
<h4><code><a title="auton_survival.models.dsm.DeepRecurrentSurvivalMachines" href="#auton_survival.models.dsm.DeepRecurrentSurvivalMachines">DeepRecurrentSurvivalMachines</a></code></h4>
</li>
<li>
<h4><code><a title="auton_survival.models.dsm.DeepConvolutionalSurvivalMachines" href="#auton_survival.models.dsm.DeepConvolutionalSurvivalMachines">DeepConvolutionalSurvivalMachines</a></code></h4>
</li>
<li>
<h4><code><a title="auton_survival.models.dsm.DeepCNNRNNSurvivalMachines" href="#auton_survival.models.dsm.DeepCNNRNNSurvivalMachines">DeepCNNRNNSurvivalMachines</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>